<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Lab Four – Programming in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="Lab4WriteUp_files/libs/clipboard/clipboard.min.js"></script>
<script src="Lab4WriteUp_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="Lab4WriteUp_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="Lab4WriteUp_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="Lab4WriteUp_files/libs/quarto-html/popper.min.js"></script>
<script src="Lab4WriteUp_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Lab4WriteUp_files/libs/quarto-html/anchor.min.js"></script>
<link href="Lab4WriteUp_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Lab4WriteUp_files/libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Lab4WriteUp_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Lab4WriteUp_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Lab4WriteUp_files/libs/bootstrap/bootstrap-d6a003b94517c951b2d65075d42fb01b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Lab4WriteUp.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab Four – Programming in R</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p></p>
<p></p>
<ul>
<li>Complete the tasks below. Make sure to start your solutions in on a new line that starts with “<strong>Solution</strong>:”.</li>
<li>Make sure to use the Quarto Cheatsheet. This will make completing and writing up the lab <em>much</em> easier.</li>
</ul>
<p>In this lab, we will build a mealkit recipe generator. I created a small website of about 40 recipes. We will scrape recipes from that website, randomly select three meals, and print a grocery list with recipe cards.</p>
<section id="preliminaries" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Preliminaries</h1>
<section id="part-a" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="part-a"><span class="header-section-number">1.1</span> Part a</h2>
<p>Below, I create a numeric vector filled with random observations. Ask for the 3rd item.<br> <strong>Note</strong>: The <code>set.seed(7272)</code> portion ensures we all get the same answer.</p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">set.seed</span>(<span class="dv">7272</span>) <span class="co"># sets the randomization seed for replication</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,          <span class="co"># sample from 1, 2, 3, ..., 10 </span></span>
<span id="cb1-3"><a href="#cb1-3"></a>            <span class="at">size=</span><span class="dv">10</span>,         <span class="co"># sample of 10</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>            <span class="at">replace =</span> <span class="cn">TRUE</span>)  <span class="co"># allowed to sample the same item multiple times</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p></p>
<p><strong>Solution</strong></p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>x[<span class="dv">3</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
<p></p>
</section>
<section id="part-b" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="part-b"><span class="header-section-number">1.2</span> Part b</h2>
<p>Below, I create a data frame filled with random observations.</p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">set.seed</span>(<span class="dv">7272</span>) <span class="co"># sets the randomization seed for replication</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fu">sample</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,          <span class="co"># sample from 1, 2, 3, ..., 10 </span></span>
<span id="cb4-3"><a href="#cb4-3"></a>                             <span class="at">size=</span><span class="dv">10</span>,         <span class="co"># sample of 10</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>                             <span class="at">replace =</span> <span class="cn">TRUE</span>), <span class="co"># allowed to sample the same item multiple times</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>                 <span class="at">x2 =</span> <span class="fu">sample</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,          <span class="co"># sample from 1, 2, 3, ..., 10 </span></span>
<span id="cb4-6"><a href="#cb4-6"></a>                             <span class="at">size=</span><span class="dv">10</span>,         <span class="co"># sample of 10</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>                             <span class="at">replace =</span> <span class="cn">TRUE</span>), <span class="co"># allowed to sample the same item multiple times</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>                 <span class="at">x3 =</span> <span class="fu">sample</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,          <span class="co"># sample from 1, 2, 3, ..., 10 </span></span>
<span id="cb4-9"><a href="#cb4-9"></a>                             <span class="at">size=</span><span class="dv">10</span>,         <span class="co"># sample of 10</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>                             <span class="at">replace =</span> <span class="cn">TRUE</span>)  <span class="co"># allowed to sample the same item multiple times,</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p></p>
</section>
<section id="part-b-1" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="part-b-1"><span class="header-section-number">1.3</span> Part b</h2>
<p>Use the <code>head(...)</code> function to peek at the data frame.</p>
<p><strong>Solution</strong></p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">head</span>(df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  x1 x2 x3
1  8  1  8
2  3  7  2
3  5  3  3
4  3  6  2
5  2  2  3
6  3  8 10</code></pre>
</div>
</div>
<p></p>
</section>
<section id="part-c" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="part-c"><span class="header-section-number">1.4</span> Part c</h2>
<p>Ask for the column <code>x1</code>.</p>
<p><strong>Solution</strong></p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>df[,<span class="dv">1</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 8 3 5 3 2 3 1 2 6 2</code></pre>
</div>
</div>
<p></p>
</section>
<section id="part-d" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="part-d"><span class="header-section-number">1.5</span> Part d</h2>
<p>Ask for the fifth row of the data frame.</p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>df[<span class="dv">5</span>,]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  x1 x2 x3
5  2  2  3</code></pre>
</div>
</div>
<p></p>
</section>
<section id="part-e" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="part-e"><span class="header-section-number">1.6</span> Part e</h2>
<p>Ask for the the value of <code>x1</code> in the fifth row of the data frame.</p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>df[<span class="dv">5</span>,<span class="dv">1</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p></p>
</section>
<section id="part-f" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="part-f"><span class="header-section-number">1.7</span> Part f</h2>
<p>Ask for the the value of in the third column and the fifth row of the data frame.</p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>df[<span class="dv">5</span>,<span class="dv">3</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<p></p>
</section>
<section id="part-g" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="part-g"><span class="header-section-number">1.8</span> Part g</h2>
<p>Create a sequence from 1 to 10 by 2 and use it to print the odd rows of the data frame.</p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>sq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>df[sq,]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  x1 x2 x3
1  8  1  8
3  5  3  3
5  2  2  3
7  1 10  1
9  6  2 10</code></pre>
</div>
</div>
<p></p>
</section>
<section id="part-h" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="part-h"><span class="header-section-number">1.9</span> Part h</h2>
<p>Below, I create an empty column called <code>x12</code>. Fill in the details of the <code>for(...)</code> loop to ensure <code>x12</code> is the product of <code>x1</code> and <code>x2</code>.</p>
<p><strong>Solution</strong></p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>df2 <span class="ot">&lt;-</span> df   <span class="co"># Save it as a new dataframe</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(df2)                <span class="co"># How many rows to we have to fill?</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>df2<span class="sc">$</span>x12 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">nrow</span>(df2))   <span class="co"># Create an empty column for x12</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df2)){</span>
<span id="cb17-5"><a href="#cb17-5"></a>  df2[i,<span class="dv">4</span>] <span class="ot">&lt;-</span> df2[i,<span class="dv">1</span>] <span class="sc">*</span> df2[i,<span class="dv">2</span>] <span class="co"># replacing each row in the new column with x1 * x2</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>}</span>
<span id="cb17-7"><a href="#cb17-7"></a>df2[,]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   x1 x2 x3 x12
1   8  1  8   8
2   3  7  2  21
3   5  3  3  15
4   3  6  2  18
5   2  2  3   4
6   3  8 10  24
7   1 10  1  10
8   2  6  1  12
9   6  2 10  12
10  2  4  1   8</code></pre>
</div>
</div>
<p></p>
</section>
<section id="part-i" class="level2" data-number="1.10">
<h2 data-number="1.10" class="anchored" data-anchor-id="part-i"><span class="header-section-number">1.10</span> Part i</h2>
<p>Write a function called <code>calculate.score(...)</code> that takes three arguments representing <code>x1</code>, <code>x2</code>, and <code>x3</code>) and returns a single value based on the formula: <span class="math display">\[Score = (x_1 \times 2) + x_2 - x_3\]</span> Use your function to create a new column <code>total.score</code> in our data frame <code>df</code>.</p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>df3 <span class="ot">&lt;-</span> df2</span>
<span id="cb19-2"><a href="#cb19-2"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(df3)                <span class="co"># How many rows to we have to fill?</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>df3<span class="sc">$</span>total.score <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">nrow</span>(df3))   <span class="co"># Create an empty column for total.score</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df3)){</span>
<span id="cb19-5"><a href="#cb19-5"></a>  df3[i,<span class="dv">5</span>] <span class="ot">&lt;-</span> (df3[i,<span class="dv">1</span>]<span class="sc">*</span><span class="dv">2</span>) <span class="sc">+</span> df3[i,<span class="dv">2</span>] <span class="sc">-</span> df3[i,<span class="dv">3</span>]</span>
<span id="cb19-6"><a href="#cb19-6"></a>}</span>
<span id="cb19-7"><a href="#cb19-7"></a>df3[,]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   x1 x2 x3 x12 total.score
1   8  1  8   8           9
2   3  7  2  21          11
3   5  3  3  15          10
4   3  6  2  18          10
5   2  2  3   4           3
6   3  8 10  24           4
7   1 10  1  10          11
8   2  6  1  12           9
9   6  2 10  12           4
10  2  4  1   8           7</code></pre>
</div>
</div>
<p></p>
</section>
<section id="part-j" class="level2" data-number="1.11">
<h2 data-number="1.11" class="anchored" data-anchor-id="part-j"><span class="header-section-number">1.11</span> Part j</h2>
<p>Create a function called <code>evaluate.row(...)</code> that takes one argument and returns “low” when the argument is less than 4, “mid” when the argument is between 4 and 7 (inclusive), and “high” when the arguement is 8 or larger. Then, use <code>sapply(...)</code> to apply it to column <code>x1</code>.</p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>evaluate.row <span class="ot">&lt;-</span> <span class="cf">function</span>(number){</span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="cf">if</span>(number <span class="sc">&lt;</span> <span class="dv">4</span>){</span>
<span id="cb21-3"><a href="#cb21-3"></a>     <span class="st">"low"</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>  }<span class="cf">else</span> <span class="cf">if</span> (<span class="dv">4</span> <span class="sc">&lt;</span> number <span class="sc">&amp;</span> number <span class="sc">&lt;=</span> <span class="dv">7</span>){</span>
<span id="cb21-5"><a href="#cb21-5"></a>     <span class="st">"mid"</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>  }<span class="cf">else</span>{</span>
<span id="cb21-7"><a href="#cb21-7"></a>     <span class="st">"high"</span></span>
<span id="cb21-8"><a href="#cb21-8"></a>  }</span>
<span id="cb21-9"><a href="#cb21-9"></a> }</span>
<span id="cb21-10"><a href="#cb21-10"></a>df4 <span class="ot">&lt;-</span> df3</span>
<span id="cb21-11"><a href="#cb21-11"></a>df4[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(df4[,<span class="dv">1</span>],evaluate.row)</span>
<span id="cb21-12"><a href="#cb21-12"></a>df4[]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     x1 x2 x3 x12 total.score
1  high  1  8   8           9
2   low  7  2  21          11
3   mid  3  3  15          10
4   low  6  2  18          10
5   low  2  3   4           3
6   low  8 10  24           4
7   low 10  1  10          11
8   low  6  1  12           9
9   mid  2 10  12           4
10  low  4  1   8           7</code></pre>
</div>
</div>
<p></p>
</section>
<section id="part-k" class="level2" data-number="1.12">
<h2 data-number="1.12" class="anchored" data-anchor-id="part-k"><span class="header-section-number">1.12</span> Part k</h2>
<p>Did we need to use loops or functions in (h.)-(j.)? That is, can we use vectorization to attain the same results in 1 line each? Where it is possible, write the line of code. Where it is not, explain why.</p>
<p><strong>Solution</strong></p>
<p>Part h</p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>df<span class="sc">$</span>x12 <span class="ot">&lt;-</span> df[,<span class="dv">1</span>] <span class="sc">*</span> df[,<span class="dv">2</span>]   <span class="co"># Create a new column using x1 * x2</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>df[]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   x1 x2 x3 x12
1   8  1  8   8
2   3  7  2  21
3   5  3  3  15
4   3  6  2  18
5   2  2  3   4
6   3  8 10  24
7   1 10  1  10
8   2  6  1  12
9   6  2 10  12
10  2  4  1   8</code></pre>
</div>
</div>
<p></p>
<p>Part i</p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>df<span class="sc">$</span>total.score <span class="ot">&lt;-</span> (df[,<span class="dv">1</span>] <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span> df[,<span class="dv">2</span>] <span class="sc">-</span> df[,<span class="dv">3</span>]   </span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="co"># Create a new column using testscore function</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>df[]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   x1 x2 x3 x12 total.score
1   8  1  8   8           9
2   3  7  2  21          11
3   5  3  3  15          10
4   3  6  2  18          10
5   2  2  3   4           3
6   3  8 10  24           4
7   1 10  1  10          11
8   2  6  1  12           9
9   6  2 10  12           4
10  2  4  1   8           7</code></pre>
</div>
</div>
<p></p>
</section>
</section>
<section id="complete-tasks-for-one-recipe" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Complete Tasks for One Recipe</h1>
<section id="part-a-1" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="part-a-1"><span class="header-section-number">2.1</span> Part a</h2>
<p>Install and load the <code>rvest</code> package <span class="citation" data-cites="rvest">(<a href="#ref-rvest" role="doc-biblioref">Wickham 2025</a>)</span>.</p>
</section>
<section id="part-b-2" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="part-b-2"><span class="header-section-number">2.2</span> Part b</h2>
<p>Load the html of the <code>website/KimchiGrilledCheese.html</code> using the <code>read_html()</code> function and save the result to an object called <code>recipe.item</code>. We will use the Kimchi Grilled Cheese recipe as our prototype and extend this workflow to all recipes, so try to be as general as possible. If you do look at it, you’ll notice it contains the html we saw in the developer tools in class.<br> <strong>Hint</strong>: You can use <code>read_html(...)</code> like <code>read.csv(...)</code>. Don’t forget you can use the documentation to help use it.</p>
<p><strong>Solution</strong></p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">library</span>(<span class="at">package =</span> <span class="st">"rvest"</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>recipe.item <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">"website/KimchiGrilledCheese.html"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p></p>
</section>
<section id="part-c-1" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="part-c-1"><span class="header-section-number">2.3</span> Part c</h2>
<p>Open the html file in a web browser and open developer tools. In chrome-based browsers, you can do this by pressing the three verticle dots in the upper-right corner, clicking “more tools”, then “developer tools”.</p>
<p>Find the name of the Ingredients section of the website and pull the HTML of the function using <code>html_element(...)</code> and save the results to an object called <code>ingredients.section</code>. <br> <strong>Hint</strong>: You can ask for elements by id using a preceeding “#”. See <code>?html_element(...)</code> for a helpful example.</p>
<p><strong>Solution</strong></p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>ingredients.section <span class="ot">&lt;-</span> <span class="fu">html_element</span>(recipe.item, <span class="st">"#ingredients"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p></p>
</section>
<section id="part-d-1" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="part-d-1"><span class="header-section-number">2.4</span> Part d</h2>
<p>Now, we want to obtain all of the itemized items. Find the element type the individual ingredients and pull all of them from <code>ingredients.section</code> using <code>html_elements(...)</code> (note the added s) and save the results to an object called <code>ingredients</code>.<br> <strong>Hint</strong>: You can ask for elements by type by simply specifying the tag (e.g., “p” for paragraph). See `?html_element for a helpful example.</p>
<p><strong>Solution</strong></p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>ingredients <span class="ot">&lt;-</span> <span class="fu">html_elements</span>(ingredients.section, <span class="st">"li"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p></p>
</section>
<section id="part-e-1" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="part-e-1"><span class="header-section-number">2.5</span> Part e</h2>
<p>Similar to Part c.&nbsp;Find the name of the Instructions section of the website and pull the HTML of the function using <code>html_element(...)</code> and save the results to an object called <code>instructions.section</code>.<br></p>
<p><strong>Solution</strong></p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>instructions.section <span class="ot">&lt;-</span> <span class="fu">html_element</span>(recipe.item, <span class="st">"#instructions"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p></p>
</section>
<section id="part-f-1" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="part-f-1"><span class="header-section-number">2.6</span> Part f</h2>
<p>Now, we want to obtain all of the enumerated items. Find the element type the individual instructions and pull all of them from <code>instructions.section</code> using <code>html_elements(...)</code> (note the added s) and save the results to an object called <code>instructions</code>.</p>
<p><strong>Solution</strong></p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>instructions <span class="ot">&lt;-</span> <span class="fu">html_elements</span>(instructions.section, <span class="st">"li"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p></p>
</section>
<section id="part-g-1" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="part-g-1"><span class="header-section-number">2.7</span> Part g</h2>
<p>Find the class of the recipe image and pull the HTML using <code>html_element(...)</code> and save the results to an object called <code>image.element</code>. <br> <strong>Hint</strong>: You can ask for elements by class using a preceeding “.”. See <code>?html_element(...)</code> for a helpful example. Further, note that HTML elements may have more than one class (separated by a space). When that is the case, you need to choose one.</p>
<p><strong>Solution</strong></p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>image.element <span class="ot">&lt;-</span> <span class="fu">html_element</span>(recipe.item, <span class="st">".figure-img"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p></p>
</section>
<section id="part-h-1" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="part-h-1"><span class="header-section-number">2.8</span> Part h</h2>
<p>Use the <code>html_attr(...)</code> function to pull the source link (“src”). Then, use <code>paste(...)</code> to prepend the source link with “website/” so we have the full link.<br> <strong>Note</strong>: This would be like adding “https://www.website.com” to get the absolute link.</p>
<p></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>image.url <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"website/"</span>, <span class="fu">html_attr</span>(image.element,<span class="st">"src"</span>), <span class="at">sep =</span> <span class="st">""</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p></p>
</section>
<section id="part-i-1" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="part-i-1"><span class="header-section-number">2.9</span> Part i</h2>
<p>Now that we have all the things we need, let’s try to print the recipe. Below, I have written code to print from the objects. One by one, remove <code>#| eval: false</code> from the YAML header and add <code>#| echo: false</code> and <code>#| results: 'asis'</code>, and test. Let me know if you’re stuck!</p>
<p><strong>Image</strong></p>
<p></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Kimchi Grilled Cheese</figcaption>
<p><img src="website/images/KimchiGrilledCheese.jpg" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
<p></p>
<p><strong>Ingredients</strong></p>
<p></p>
<ul>
<li>1/8 tsp chili flakes</li>
<li>4 garlic cloves</li>
<li>5 oz spinach</li>
<li>1 tsp gochujang</li>
<li>3 tsp mayonnaise</li>
<li>2/3 cup kimchi</li>
<li>4 slices of bread</li>
<li>2/3 cup cheddar cheese</li>
<li>4 tablespoons everything seasoning.</li>
</ul>
<p></p>
<p><strong>Instructions</strong></p>
<p></p>
<ol type="1">
<li>In a frying pan, heat 2 tablespoons olive oil with chili flakes.</li>
<li>Add spinach and cook until wilted.</li>
<li>Mix gochujang and mayonnaise in a small bowl and spread on one side of each slice of bread. Sprinkle with everything seasoning and press it into the bread.</li>
<li>Build sandwiches by layering spinach, kimchi, and cheese between two slices of bread.</li>
<li>Fry in butter until golden brown on both sides.</li>
</ol>
<p></p>
</section>
</section>
<section id="complete-a-full-menu" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Complete a Full Menu!</h1>
<p>Open <code>Menu.qmd</code> and add code to complete the following.</p>
<ol type="1">
<li>Randomly select three dinner recipes and one breakfast recipe at random.<br> <strong>Hint:</strong> Use the <code>sample(...)</code> function.</li>
<li>Pull the image, ingredients, and instructions for each selected recipe.</li>
<li>Combine all of the ingredients into a grocery list on the first page.</li>
<li>Print the image, ingredients, and instructions for each receipe on the subsequent pages.</li>
</ol>
<p>When you render this document, no code should be visible. Instead, you should see a five-page document as described above.</p>
</section>
<section id="describe-your-work" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Describe your work!</h1>
<section id="why-a-fake-website" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="why-a-fake-website"><span class="header-section-number">4.1</span> Why a fake website?</h2>
<p>Read <a href="Is%20Web%20Sraping%20Legal?">https://www.scrapingbee.com/blog/is-web-scraping-legal/</a>. Originally, I conceived doing this with recipes from Purple Carrot (my favorite subscription service). Being a large company, their terms of service are <em>very</em> long and precluded us from copying their recipes. We also checked a few smaller recipe websites we like and even they had terms of service that restricted automated collection of data.</p>
</section>
<section id="conditionals" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="conditionals"><span class="header-section-number">4.2</span> Conditionals</h2>
<p>Did you use conditional statements in your code? If yes, how. If not, are there places you could have used them but did something else?</p>
</section>
<section id="loops" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="loops"><span class="header-section-number">4.3</span> Loops</h2>
<p>Did you use loops in your code? If yes, how. If not, are there places you could have used them but did something else?</p>
</section>
<section id="functions" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="functions"><span class="header-section-number">4.4</span> Functions</h2>
<p>Did you use functions in your code? If yes, how. If not, are there places you could have used them but did something else?</p>

</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-rvest" class="csl-entry" role="listitem">
Wickham, Hadley. 2025. <em>Rvest: Easily Harvest (Scrape) Web Pages</em>. <a href="https://doi.org/10.32614/CRAN.package.rvest">https://doi.org/10.32614/CRAN.package.rvest</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>